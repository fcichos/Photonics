{
  "hash": "3ed09ce0775bddeaf0e965e57227b2b6",
  "result": {
    "engine": "jupyter",
    "markdown": "---\n#title: \"Theories of Light\"\njupyter: python3\nformat:\n  html:\n    toc: true\n    toc-location: right\n    fig-cap-location: bottom\ncrossref:\n  fig-title: Figure\n  tbl-title: Table\n  title-delim: \"—\"\n  fig-prefix: Figure\n  eq-prefix: Equation\n  chapters: true\n  fig-labels: arabic\n---\n\n\n\n<!-- ## Ray Optics (20 minutes) -->\n\n## Theories for light\n\nLight has been described through increasingly sophisticated theoretical frameworks throughout the history of physics. The simplest framework is *Ray Optics* or *Geometrical Optics*, which treats light as rays traveling along straight paths and applies geometrical principles to describe interactions with optical elements like lenses and mirrors. Moving beyond this approximation, *Wave Optics* introduces the wave nature of light, explaining phenomena such as interference and diffraction that ray optics cannot address. *Electromagnetic Optics* further refines our understanding by treating light as electromagnetic waves governed by Maxwell's equations, providing a complete classical description of light-matter interactions. For intense light sources, *Nonlinear Optics* becomes essential, describing how materials respond nonlinearly to strong electromagnetic fields, giving rise to frequency conversion and other novel effects. Finally, at the most fundamental level, *Quantum Optics* treats light as consisting of photons—quantum mechanical particles exhibiting both wave and particle properties—essential for understanding phenomena like spontaneous emission, entanglement, and the quantum nature of light-matter interactions. This course will progressively build your understanding through these increasingly sophisticated frameworks.\n\n### Ray Optics\n\nRay optics, or geometric optics, provides a powerful framework for understanding light propagation when the wavelength is much **smaller than the dimensions of optical elements** involved. In this approach, light travels along straight lines called rays in homogeneous media, with well-defined paths that can be mathematically traced. This description serves as the foundation for analyzing many optical systems, from simple mirrors to complex microscopes and telescopes.\n\n#### Fermat's Principle: Integral and Differential Forms\n\n**Fermat's Principle** forms the foundation of ray optics, stating that light travels along the route that minimizes the total optical path length between any two points. This optical path length, expressed mathematically as $\\int_C n(s)ds$, represents the effective distance light traverses through media of varying refractive indices. When this quantity is divided by the vacuum speed of light $c_0$, it yields the total travel time required for light to journey between those points.\n\nIn its integral form:\n\n$$\\delta\\int_C n(s)ds = 0$$\n\nwhere $n(s)$ is the refractive index along path $C$ and $ds$ is the differential path length.\n\n\nThe same principle can be expressed as a differential equation that describes how light bends in media with varying refractive indices:\n\n$$\\frac{d}{ds}\\left(n\\frac{d\\mathbf{r}}{ds}\\right) = \\nabla n$$\n\nThis equation shows that rays bend toward regions of higher refractive index. In homogeneous media ($\\nabla n = 0$), it simplifies to $\\frac{d^2\\mathbf{r}}{ds^2} = 0$, confirming that light follows straight lines.\n\n#### Optical Laws Derived from Fermat's Principle\n\n**Reflection**: At a planar interface, Fermat's Principle directly yields the law of reflection:\n\n$$\\theta_i = \\theta_r$$\n\nwhere $\\theta_i$ is the angle of incidence and $\\theta_r$ is the angle of reflection, both measured from the normal to the surface.\n\n::: {#cell-fig-fermat-reflection .cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\"}\ndef calculate_path_length(x, start, end):\n    \"\"\"Calculate the total path length from start to point x to end\"\"\"\n    d1 = np.sqrt((x - start[0])**2 + (start[1])**2)\n    d2 = np.sqrt((end[0] - x)**2 + (end[1])**2)\n    return d1 + d2\n\n# Set up the figure\nfig, ax = plt.subplots(figsize=get_size(15, 10))\n\n# Define start and end points\nstart_point = (-4, 3)\nend_point = (4, 3)\n\n# X positions for different possible paths\nx_positions = np.linspace(-3.5, 3.5, 15)\n\n# Calculate path lengths\npath_lengths = [calculate_path_length(x, start_point, end_point) for x in x_positions]\n\n# Find the minimum path (Fermat's principle)\nmin_index = np.argmin(path_lengths)\nmin_x = x_positions[min_index]\n\n# Plot the horizontal line (interface)\nax.axhline(y=0, color='black', linestyle='-', linewidth=1)\n\n# Plot all possible paths\nfor i, x in enumerate(x_positions):\n    if i == min_index:\n        continue  # Skip the minimum path for now\n\n    # Create path\n    verts = [\n        start_point,\n        (x, 0),\n        end_point\n    ]\n    codes = [\n        Path.MOVETO,\n        Path.LINETO,\n        Path.LINETO\n    ]\n    path = Path(verts, codes)\n    patch = patches.PathPatch(path, facecolor='none', edgecolor='gray',\n                             linestyle='--', lw=0.5,alpha=0.65)\n    ax.add_patch(patch)\n\n# Plot the minimum path (Fermat's Principle)\nverts = [\n    start_point,\n    (min_x, 0),\n    end_point\n]\ncodes = [\n    Path.MOVETO,\n    Path.LINETO,\n    Path.LINETO\n]\npath = Path(verts, codes)\npatch = patches.PathPatch(path, facecolor='none', edgecolor='red',\n                         linestyle='-')\nax.add_patch(patch)\n\n# Add dots for the points\nax.plot(start_point[0], start_point[1], 'bo', label='start point')\nax.plot(end_point[0], end_point[1], 'go',  label='end point')\nax.plot(min_x, 0, 'ro',  label='reflection Point')\n\n# Set labels and title\nax.set_xlabel('x-position')\nax.set_ylabel('y-position')\nax.text(-0.7, -1, \"mirror\")\n\n# Set plot limits and legend\nax.set_xlim(-5, 5)\nax.set_ylim(-4, 4)\nax.set_aspect('equal')\nax.legend()\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Fermat's principle for reflection of light at an interface](01-lecture01_files/figure-html/fig-fermat-reflection-output-1.svg){#fig-fermat-reflection}\n:::\n:::\n\n\n**Refraction**: Between media with different refractive indices, Fermat's Principle yields Snell's law:\n\n$$n_1\\sin\\theta_1 = n_2\\sin\\theta_2$$\n\nwhere $\\theta_1$ and $\\theta_2$ are the angles of incidence and refraction, respectively.\n\n::: {#cell-fig-fermat-refraction .cell execution_count=3}\n``` {.python .cell-code code-fold=\"true\"}\ndef calculate_optical_path(x, start, end, n1, n2):\n    \"\"\"Calculate the total optical path length from start to point x to end\"\"\"\n    d1 = n1 * np.sqrt((x - start[0])**2 + (start[1])**2)  # Optical path in medium 1\n    d2 = n2 * np.sqrt((end[0] - x)**2 + (end[1])**2)      # Optical path in medium 2\n    return d1 + d2\n\n# Set up the figure\nfig, ax = plt.subplots(figsize=get_size(15, 10))\n\n# Define start and end points\nstart_point = (-4, 3)\nend_point = (4, -3)\n\n# Define refractive indices\nn1 = 1.0  # Medium 1 (above interface)\nn2 = 1.5  # Medium 2 (below interface)\n\n# X positions for different possible paths\nx_positions = np.linspace(-3.5, 3.5, 15)\n\n# Calculate optical path lengths\noptical_paths = [calculate_optical_path(x, start_point, end_point, n1, n2) for x in x_positions]\n\n# Find the minimum path (Fermat's principle)\nmin_index = np.argmin(optical_paths)\nmin_x = x_positions[min_index]\n\n# Plot the horizontal line (interface)\nax.axhline(y=0, color='black', linestyle='-', linewidth=1)\n\n# Plot all possible paths\nfor i, x in enumerate(x_positions):\n    if i == min_index:\n        continue  # Skip the minimum path for now\n\n    # Create path\n    verts = [\n        start_point,\n        (x, 0),\n        end_point\n    ]\n    codes = [\n        Path.MOVETO,\n        Path.LINETO,\n        Path.LINETO\n    ]\n    path = Path(verts, codes)\n    patch = patches.PathPatch(path, facecolor='none', edgecolor='gray',\n                             linestyle='--', lw=0.5, alpha=0.65)\n    ax.add_patch(patch)\n\n# Plot the minimum path (Fermat's Principle)\nverts = [\n    start_point,\n    (min_x, 0),\n    end_point\n]\ncodes = [\n    Path.MOVETO,\n    Path.LINETO,\n    Path.LINETO\n]\npath = Path(verts, codes)\npatch = patches.PathPatch(path, facecolor='none', edgecolor='red',\n                         linestyle='-', lw=1)\nax.add_patch(patch)\n\n# Add dots for the points\nax.plot(start_point[0], start_point[1], 'bo', label='start')\nax.plot(end_point[0], end_point[1], 'go', label='end')\nax.plot(min_x, 0, 'ro', label='refraction')\n\n# Calculate and draw angles\n# Incident ray\ndx1 = min_x - start_point[0]\ndy1 = 0 - start_point[1]\nincident_angle = np.arctan2(-dy1, dx1)\ntheta1 = np.pi/2 - incident_angle\n\n# Refracted ray\ndx2 = end_point[0] - min_x\ndy2 = end_point[1] - 0\nrefracted_angle = np.arctan2(dy2, dx2)\ntheta2 = np.pi/2 + refracted_angle\n\n# Draw angle arcs\n\n# Add angle labels\nax.text(min_x + 0.3, 0.3, r'$\\theta_1$', color='blue')\nax.text(min_x - 0.5, -0.3, r'$\\theta_2$', color='green')\n\n# Set labels and title\nax.set_xlabel('x-position')\nax.set_ylabel('y-position')\nax.text(-3, 0.5, f\"n₁ = {n1}\", color='blue')\nax.text(-3, -0.5, f\"n₂ = {n2}\", color='green')\n\n# Set plot limits and legend\nax.set_xlim(-5, 5)\nax.set_ylim(-4, 4)\nax.set_aspect('equal')\nax.legend()\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Snell's Law from Fermat's Principle](01-lecture01_files/figure-html/fig-fermat-refraction-output-1.svg){#fig-fermat-refraction}\n:::\n:::\n\n\n::: {.callout-note collapse=\"true\"}\n### Detailed Derivations from Fermat's Principle\n\n#### Reflection Law Derivation\nFor reflection at a planar interface, we consider a ray traveling from point A to point B via reflection at point P on a mirror. The total path length is $L = |AP| + |PB|$. According to Fermat's Principle, the actual path minimizes $L$, so we set:\n\n$$\\frac{dL}{dx} = 0$$\n\nwhere $x$ is the position of P along the mirror. This leads to the condition that the angle of incidence equals the angle of reflection.\n\n**Law of Reflection**: The angle of incidence equals the angle of reflection.\n$$\\theta_i = \\theta_r$$\n\n#### Refraction Law Derivation\nFor refraction between two media, the optical path length is:\n\n$$L = n_1|AP| + n_2|PB|$$\n\nApplying the minimization condition $\\frac{dL}{dx} = 0$ yields Snell's law.\n\n**Snell's Law**: The ratio of the sines of the angles of incidence and refraction equals the reciprocal of the ratio of the refractive indices.\n$$n_1\\sin\\theta_1 = n_2\\sin\\theta_2$$\n\n#### Differential Form Derivation\nTo derive the differential ray equation from Fermat's integral principle, we apply the calculus of variations. Starting with the optical path length functional:\n\n$$L = \\int_C n(s)ds = \\int_{t_1}^{t_2} n(\\mathbf{r}(t)) \\left|\\frac{d\\mathbf{r}}{dt}\\right| dt$$\n\nWhere $\\mathbf{r}(t)$ parametrizes the path. The term $\\left|\\frac{d\\mathbf{r}}{dt}\\right|$ represents the differential element of arc length $ds$ along the path, so $ds = \\left|\\frac{d\\mathbf{r}}{dt}\\right| dt$. This parametrization allows us to convert the path integral over the curve $C$ into a definite integral over the parameter $t$. According to Fermat's principle, the true path makes this integral stationary (δL = 0).\n\nConsider a small variation in the path: $\\mathbf{r}(t) \\rightarrow \\mathbf{r}(t) + \\epsilon\\mathbf{\\eta}(t)$ where $\\mathbf{\\eta}(t_1) = \\mathbf{\\eta}(t_2) = 0$ (fixed endpoints). Expanding the variation of the integral to first order in ε:\n\n$$\\delta L = \\frac{d}{d\\epsilon}\\bigg|_{\\epsilon=0} \\int_{t_1}^{t_2} n(\\mathbf{r}(t) + \\epsilon\\mathbf{\\eta}(t)) \\left|\\frac{d}{dt}(\\mathbf{r}(t) + \\epsilon\\mathbf{\\eta}(t))\\right| dt$$\n\nUsing the chain rule and reparametrizing with arc length $s$ (where $\\frac{d\\mathbf{r}}{ds}$ is a unit vector), the stationarity condition leads to:\n\n$$\\int_C \\left[ \\nabla n \\cdot \\mathbf{\\eta} - \\frac{d}{ds}\\left(n\\frac{d\\mathbf{r}}{ds}\\right) \\cdot \\mathbf{\\eta} \\right] ds = 0$$\n\nSince this must hold for any variation $\\mathbf{\\eta}$, we obtain the Euler-Lagrange equation:\n\n$$\\frac{d}{ds}\\left(n\\frac{d\\mathbf{r}}{ds}\\right) = \\nabla n$$\n\nThis shows that rays bend toward regions of higher refractive index, directly analogous to how a mechanical particle's trajectory is affected by a potential field in classical mechanics.\n:::\n\n\n### Lenses\n\nThe most important optical elements are lenses, which come in many different flavors. They consist of curved surfaces, which most commonly have the shape of a part of a spherical cap. It is, therefore, useful to have a look at the refraction at spherical surfaces.\n\n#### Refraction at spherical surfaces\n\nFor our calculations of the refraction at spherical surfaces, we consider the sketch below.\n\n::: {#fig-curved-surface fig-align=\"center\"}\n![](img/curved_surface.png){width=80%}\n\nRefraction at a curved surface.\n:::\n\nTo derive an imaging equation for a lens, we aim to calculate the distance $b$ and angle $\\theta_2$ at which a ray crosses the optical axis, given its origin at distance $a$ and angle $\\theta_1$. We begin with Snell's law for the geometry:\n\n$$n_{1}\\sin(\\alpha+\\theta_1)=n_{2}\\sin(\\alpha-\\theta_2)$$\n\nWe define key relationships:\n\n$$\\sin(\\alpha)=\\frac{y}{R}, \\quad \\tan(\\theta_1)=\\frac{y}{a}, \\quad \\tan(\\theta_2)=\\frac{y}{b}$$\n\nTo simplify this, we employ the **paraxial approximation**, which assumes all angles are small. This allows us to use first-order approximations of trigonometric functions, effectively linearizing them:\n\n$$\\sin(\\theta) \\approx \\theta+ O(\\theta^{3}), \\quad \\tan(\\theta) \\approx \\theta + O(\\theta^{3}),\\quad \\cos(\\theta)\\approx 1 + O(\\theta^{2})$$\n\nThis approach, common in optics, significantly simplifies our calculations while maintaining accuracy for most practical scenarios involving lenses.\n\nWith the help of these approximations we can write Snell's law for the curved surface as\n\n$$n_1(\\alpha+\\theta_1)=n_2(\\alpha-\\theta_2).$$\n\nWith some slight transformation which you will find in the video of the online lecture we obtain, therefore,\n\n$$\\theta_2=\\frac{n_2-n_1}{n_2 R}y -\\frac{n_1}{n_2}\\theta_1,$$\n\nwhich is a purely linear equation in $y$ and $\\theta_1$.\n\n::: {.callout-note collapse=\"true\" #paraxial-approximation}\n### Paraxial Approximation\n\nThe paraxial approximation is a fundamental simplification in optics that assumes all angles are small. This allows us to use linear approximations for trigonometric functions, significantly simplifying calculations while maintaining accuracy for most practical scenarios involving lenses.\n\nTo visualize the validity of this approximation, let's examine two plots:\n\n1. The first plot compares sin(θ) (blue line) with its linear approximation θ (red dashed line) for angles ranging from 0 to π/2 radians.\n2. The second plot shows the absolute error between sin(θ) and θ.\n\nThese plots demonstrate that:\n\n1. For small angles (roughly up to 0.5 radians or about 30 degrees), the approximation is very close to the actual sine function.\n2. The error increases rapidly for larger angles, indicating the limitations of the paraxial approximation.\n\nIn most optical systems, especially those involving lenses, the angles of incident and refracted rays are typically small enough for this approximation to be valid. However, it's important to be aware of its limitations when dealing with wide-angle optical systems or scenarios where precision is critical.\n\n::: {#8c8b4830 .cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\"}\nimport numpy as np\nimport matplotlib.pyplot as plt\n# Define the range of angles (in radians)\ntheta = np.linspace(0, np.pi/2, 1000)\n\n# Calculate sin(theta) and theta (linear approximation)\nsin_theta = np.sin(theta)\nlinear_approx = theta\n\n# Calculate the absolute error\nerror = np.abs(sin_theta - linear_approx)\n\n# Create the plot with two subplots side by side\nfig, (ax1, ax2) = plt.subplots(1, 2, figsize=(7.5, 4))\n\n# Plot sin(theta) and theta on the first subplot\nax1.plot(theta, sin_theta, label='sin(θ)', color='blue')\nax1.plot(theta, linear_approx, label='θ', color='red', linestyle='--')\nax1.set_xlabel(r'$\\theta$ [rad]')\nax1.set_ylabel(r'$\\sin(x),x$')\nax1.legend()\n\n# Plot the error on the second subplot\nax2.plot(theta, error, label='Absolute Error', color='green')\nax2.set_xlabel(r'$\\theta$ [rad]')\nax2.set_ylabel('|sin(θ) - θ|')\nax2.legend()\n\n# Adjust the layout and display the plot\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Visualization of the paraxial approximation plotting the $\\sin(\\theta)$ and the linear approximation $\\theta$ (dashed line) for angles ranging from 0 to $\\pi/2$ radians.](01-lecture01_files/figure-html/cell-5-output-1.svg){}\n:::\n:::\n\n\n:::\n\nConsider light originating from a point at distance $y$ from the optical axis. We'll analyze two rays: one traveling parallel to the optical axis and hitting the spherical surface at height $y$, and another incident at $y=0$.\n\n::: {#fig-image-curved fig-align=\"center\"}\n![](img/image_curved.png){width=80%}\n\nImage formation at a curved surface.\n:::\n\nApplying our derived formula to these two cases:\n\nFor the parallel ray ($\\theta_1=0$):\n\n$$\\theta_2=\\frac{n_2-n_1}{n_2}\\frac{y}{R}$$\n$$\\theta_2=\\frac{y+\\Delta y}{b}$$\n\nEquating these expressions:\n\n$$\\frac{y+\\Delta y}{b}=\\frac{n_2-n_1}{n_2}\\frac{y}{R}$$\n\nFor the ray through the center ($y=0$):\n\n$$n_2\\frac{\\Delta y}{b}=n_1\\frac{y}{a}$$\n\nCombining these equations yields the imaging equation for a curved surface:\n\n$$\\frac{n_1}{a}+\\frac{n_2}{b}=\\frac{n_2-n_1}{R}$$\n\nWe can define a new quantity, the **focal length**, which depends only on the properties of the curved surface:\n\n$$f=\\frac{n_2}{n_2-n_1}R$$\n\n::: {.callout-note}\n## Imaging Equation for Spherical Refracting Surface\n\nThe sum of the inverse object and image distances equals the inverse focal length of the spherical refracting surface:\n\n$$\\frac{n_1}{a}+\\frac{n_2}{b}\\approx\\frac{n_2}{f}$$\n\nwhere the focal length of the refracting surface is given by:\n\n$$f=\\frac{n_2}{n_2-n_1}R$$\n\nin the paraxial approximation.\n:::\n\n### Thin lens\n\nIn our previous calculation we have found a linear relation between the incident angle $\\theta_1$ with the optical axis, the incident height of the ray $y$ and the outgoing angle $\\theta_2$:\n\nAnalyzing refraction in a lens involves two spherical surfaces. Light initially travels from a medium with refractive index $n_1$ into the lens material with index $n_2$. The first surface's radius, $R_1$, is typically positive for a convex surface facing the incident light.\n\nAt the second surface, the outgoing angle from the first refraction becomes the incident angle for the second refraction. Here, light travels from $n_2$ back into $n_1$. The radius $R_2$ of this surface often has a negative value in a converging lens due to its opposite curvature relative to the optical axis.\n\n::: {#fig-thin-lens-refraction fig-align=\"center\"}\n![](img/thin_lens.png){width=60%}\n\nRefraction on two spherical surfaces.\n:::\n\nFor thin lenses, where the thickness $d$ is much smaller than $R_1$ and $R_2$ ($d \\ll R_1, R_2$), we can simplify our analysis. We assume that the height of the ray at both surfaces is approximately equal ($y \\approx y'$), neglecting the displacement inside the lens.\n\nThis simplification allows us to treat all refraction as occurring on a single plane at the lens center, known as the **principal plane**. This concept, illustrated by the dashed line in the figure, greatly simplifies optical calculations and ray tracing for thin lenses.\n\nThe radii's sign convention (positive for convex surfaces facing incident light, negative for concave) and this two-surface analysis form the basis for the thin lens formula. This formula relates object distance, image distance, and focal length, encapsulating the lens's imaging properties.\n\nThe result of the above calculation is leading to the imaging equation for the thin lens.\n\n::: {.callout-note}\n## Imaging Equation for Thin Lens\n\nThe sum of the inverse object and image distances equals the inverse focal length of the thin lens:\n\n$$\\frac{1}{a}+\\frac{1}{b}\\approx\\frac{n_2-n_1}{n_1}\\left (\\frac{1}{R_1}-\\frac{1}{R_2}\\right )=\\frac{1}{f}$$\n:::\n\n::: {.callout-note}\n## Lensmaker equation\nThe focal length of a thin lens is calculated by the **lensmaker equation**:\n$$f=\\frac{n_1}{n_2-n_1}\\left ( \\frac{R_1 R_2}{R_2 -R_1}\\right)$$\n\nin the paraxial approximation.\n:::\n\n\n\n#### Image Construction\n\nImages of objects can be now constructed if we refer to rays which do not emerge from a position on the optical axis only. In this case, we consider three different rays (two are actually enough). If we use as in the case of a concave mirror a central and a parallel ray, we will find a position where all rays cross on the other side. The conversion of the rays is exactly the same as in the case of a spherical mirror. The relation between the position of the object and the image along the optical axis is described by the imaging equation.\n\n::: {#fig-thin-lens-imaging fig-align=\"center\"}\n![](img/thin_lens_imaging.png){width=60%}\n\nImage construction on a thin lens.\n:::\n\nSimilar to the concave mirror, we may now also find out the image size or the magnification of the lens.\n\n::: {.callout-note}\n## Magnification of a Lens\n\nThe magnification is given by:\n\n$$M=\\frac{h_{\\rm image}}{h_{\\rm object}}=-\\frac{b}{a}=\\frac{f}{f-a}$$\n\nwhere the negative sign is the result of the reverse orientation of the real images created by a lens.\n:::\n\nAccording to our previous consideration $M<0$ corresponds to a reversed image, while it is upright as the object for $M>0$. We, therefore, easily see the following:\n\n| Object Position | Image Characteristics | Magnification (M) | Image Type |\n|-----------------|------------------------|-------------------|------------|\n| $a < f$         | Upright and magnified  | $M > 0$           | Virtual    |\n| $f < a < 2f$    | Reversed and magnified | $M < -1$          | Real       |\n| $a = 2f$        | Reversed, same size    | $M = -1$          | Real       |\n| $a > 2f$        | Reversed and shrunk    | $-1 < M < 0$      | Real       |\n| $a = f$         | Appears at infinity    | $M = \\infty$      | -          |\n\n\nThe image below illustrates the construction of images in 4 of the above cases for a bi-convex lens, including the generation of a virtual image.\n\n|<img src=\"img/image_construction.png\" width=\"100%\">|\n|-|\n|**Fig.:** Image construction on a biconvex lens with a parallel and a central ray for different object distances.|\n\n### Thick lens\n\nFor a thin lens, the displacement of the beam in height ($y,y^{\\prime}$) due to the thickness has been neglected. That means that we can reduce all refracting action of the lens to a single plane, which we call a principle plane. This approximation is (independent of the paraxial approximation) not anymore true for lenses if the displacement $\\Delta$ of the ray as in the image below cannot be neglected. Such lenses are called **thick lenses** and they do not have a single principle plane anymore. In fact, the principle plane splits up into two principle planes at a distance $h$.\n\n::: {#fig-thick-lens-planes fig-align=\"center\"}\n![](img/thick_lens.png){width=80%}\n\nThick lens principal planes.\n:::\n\nAs indicated in the sketch above, an incident ray which is not deflected can be extended to its intersection with the optical axis at a point, which is a distance $h_1$ behind the lens surface. This is the location for the first principle plane. The position of the second principle plane at a distance $h_2$ before the back surface is found for by reversing the ray path. According to that, both principle planes have a distance $h=d-h_1+h_2$ (mind the sign of the $h$). Using some mathematical effort, one can show that the same imaging equation as for a thins lens can be used with a new definition of the focal length and taking into account that object and image distances refer to their principle planes.\n\n\n### Thin Lenses and Fermat's Principle\n\nWe can show that a thin lens obeys Fermat's principle by considering the optical path length for rays passing through different points of the lens. For a thin lens with a biconvex spherical surface of radius $R$, the thickness $d(y)$ varies with the distance $y$ from the optical axis according to:\n\n$$d(y) \\approx d_0 - \\frac{y^2}{2R}$$\n\nwhere $d_0$ is the thickness at the center. For a converging lens, the thickness decreases as we move away from the optical axis.\n\nLet's consider a ray from object point $O$ passing through the lens at height $y$ and reaching the image point $I$. The total optical path length is:\n\n$$L(y) = n_1 \\cdot |OP| + n_2 \\cdot d(y) + n_1 \\cdot |PI|$$\n\nwhere $n_1$ is the refractive index of the surrounding medium (usually air, $n_1 \\approx 1$) and $n_2$ is the refractive index of the lens material.\n\n::: {#cell-fig-lens-fermat .cell execution_count=5}\n``` {.python .cell-code code-fold=\"true\"}\n# Set up the figure\nfig, ax = plt.subplots(figsize=get_size(18, 8))\n\n# Define parameters\nf = 2  # focal length\nn_lens = 1.5  # refractive index of lens\nd0 = 0.1  # thickness at center\nobject_distance = 4\nimage_distance = 1/(1/f - 1/object_distance)  # from lens equation\n\n# Function to calculate optical path length through lens at height y\ndef optical_path(y, obj_dist, img_dist, n, d0, f):\n    # Approximate lens thickness at height y\n    d_y = d0 * (1 + y**2/(2*f*d0*(n-1)))\n\n    # Distance from object to lens entry point\n    d1 = np.sqrt(obj_dist**2 + y**2)\n\n    # Distance from lens exit point to image\n    d2 = np.sqrt(img_dist**2 + y**2)\n\n    # Total path length (air + lens + air)\n    return d1 + (n-1)*d_y + d2\n\n# Calculate optical paths for different heights\ny_values = np.linspace(-1.5, 1.5, 30)\npath_lengths = [optical_path(y, object_distance, image_distance, n_lens, d0, f) for y in y_values]\n\n# Find minimum path\nmin_index = np.argmin(path_lengths)\npath_diff = np.array(path_lengths) - min(path_lengths)\n\n# Plot lens shape (exaggerated for visibility)\nlens_width = 0.2\nx_lens = np.linspace(-lens_width/2, lens_width/2, 100)\ny_lens = np.linspace(-2, 2, 100)\nXX, YY = np.meshgrid(x_lens, y_lens)\nlens_shape = d0 + YY**2/(2*f*d0*(n_lens-1))\nlens_shape = lens_shape * lens_width/lens_shape.max()\n\n# Draw lens\nax.fill_between([-lens_shape.max()/2, lens_shape.max()/2], [-2, -2], [2, 2], color='lightblue', alpha=0.3)\nax.plot([-lens_width/4, lens_width/4], [0, 0], 'b-', linewidth=2)  # Optical axis\n\n# Plot object and image points\nax.plot(-object_distance, 0, 'bo', markersize=8, label='object')\nax.plot(image_distance, 0, 'ro', markersize=8, label='image')\n\n# Draw some example rays\nfor i, y in enumerate(y_values[::5]):\n    if i == len(y_values[::5])//2:  # Highlight central ray\n        color = 'green'\n        lw = 2\n        label1 = 'minimal path'\n    else:\n        color = 'gray'\n        lw = 0.8\n        label1 = None\n\n    # Draw ray from object through lens to image\n    ax.plot([-object_distance, 0, image_distance], [0, y, 0], color=color, linewidth=lw, label=label1)\n\n# Plot optical path length vs height - moved to bottom-right corner with more room\nax2 = ax.inset_axes([0.7, 0.75, 0.28, 0.22])  # Adjusted position and size\nax2.plot(y_values, path_diff * 1000, 'k-')  # Convert to mm for visibility\nax2.set_xlabel('height on lens (y)', fontsize=8)\nax2.set_ylabel(r'$\\Delta L$ (mm)', fontsize=8)\nax2.tick_params(axis='both', which='major', labelsize=7)\nax2.grid(True, alpha=0.3)\nax2.axhline(y=0, color='r', linestyle='--', alpha=0.5)\n\n# Set main plot properties\nax.set_xlim(-object_distance*1.1, image_distance*1.1)\nax.set_ylim(-2.5, 2.5)\nax.set_xlabel('position along optical axis')\nax.set_ylabel('height')\nax.axvline(x=0, color='k', linestyle='--', alpha=0.3)  # Mark lens position\n#ax.text(0.5, 2, \"n = \" + str(n_lens))\nax.legend(loc='upper left')  # Moved legend to upper left to avoid overlap\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Demonstration of Fermat's principle in a thin lens](01-lecture01_files/figure-html/fig-lens-fermat-output-1.svg){#fig-lens-fermat}\n:::\n:::\n\n\nApplying Fermat's principle, we require that $\\frac{dL}{dy} = 0$ for the actual ray path. After differentiation and algebraic manipulation, we arrive at:\n\n$$\\frac{y}{|OP|} + \\frac{y}{|PI|} = \\frac{y(n_2-n_1)}{R}$$\n\nThis is equivalent to the lens maker's formula when combined with the small-angle approximation. The parabolic thickness profile of the lens ensures that all rays from the object point arrive at the image point with the same optical path length (to first order), satisfying Fermat's principle.\n\nThe lens thus acts as a path equalizer - rays taking different paths through the lens all require the same travel time, which creates the focusing effect. This is why a properly designed lens can form a perfect image: it ensures constructive interference of all waves at the image point by making all optical paths equal.\n\n\n\n::: {.callout-note collapse=\"true\"}\n## Matrix Optics\nThe above derived equations for a single spherical surface yield a linear relation between the input variables $y_1$ and $\\theta_1$ and the output variables $y_2$ and $\\theta_2$.\nThe linear relation yields a great opportunity to express optical elements in terms of linear transformations (matrices). This is the basis of **matrix optics**. The matrix representation of a lens is given by\n\n$$\\begin{pmatrix} y_2 \\\\ \\theta_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ -\\frac{1}{f} & 1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ \\theta_1 \\end{pmatrix}$$\n\nwhere the matrix is called the **ABCD matrix** of the lens. Due to the linearization of Snells law w can write down more generally\n\n$$\\begin{pmatrix} y_2 \\\\\n\\theta_2 \\end{pmatrix} = \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ \\theta_1 \\end{pmatrix}$$\n\nand one can obtain a Matrix for all types of optical elements such as free space of dustance $d$.\n\n$$\\begin{bmatrix}\nA & B\\\\\nC & D\n\\end{bmatrix}\n=\n\\begin{bmatrix}\n1 & d\\\\\n0 & 1\n\\end{bmatrix}\n$$\n\nHere are some useful matrices for optical elements:\n\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{ll}\n1 & d \\\\\n0 & 1\n\\end{array}\\right] \\tag{Free space}\n$$\n\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{cc}\n1 & 0 \\\\\n0 & \\frac{n_1}{n_2}\n\\end{array}\\right] \\tag{Planar interface}\n$$\n\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{\\left(n_2-n_1\\right)}{n_2 R} & \\frac{n_1}{n_2}\n\\end{array}\\right] \\tag{Spherical Boundary}\n$$\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f} & 1\n\\end{array}\\right] \\tag{Tin Lens}\n$$\n\nIf we have now a system of optical elements, we can multiply the matrices of the individual elements to obtain the matrix of the whole system.\n\n$$\n\\rightarrow \\mathrm{M}_1 \\rightarrow \\mathrm{M}_2 \\rightarrow \\mathrm{M}_N \\rightarrow \\mathrm{M}=\\mathbf{M}_N \\ldots \\mathrm{M}_2 \\mathbf{M}_1 \\text {. }\n$$\n\nThis is a very powerful tool to analyze optical systems.\n:::\n\n\n<!-- ## Wave Optics (20 minutes)-->\n\n\n\n<!-- ## Wave Optics (20 minutes)\n- Wave equation derivation\n- Harmonic waves and their properties\n- Wave parameters: wavelength, frequency, amplitude\n- Superposition principle\n- Interference phenomena\n  - Constructive and destructive interference\n  - Young's double-slit experiment\n- Wave optics applications\n- Eikonal Theory and its applications\n-->\n\n\n## Fermat's Principle for Spherical Surfaces\n\nThe power of Fermat's principle becomes particularly evident when applied to spherical refracting surfaces. Consider a spherical boundary of radius $R$ between two media with refractive indices $n_1$ and $n_2$. According to Fermat's principle, light will follow the path that minimizes the total optical path length.\n\nFor a ray traveling from point $A$ in medium 1 to point $B$ in medium 2, refracted at point $P$ on the spherical surface, the total optical path length is:\n\n$$L = n_1|AP| + n_2|PB|$$\n\nFor the actual path taken by light, we require:\n\n$$\\frac{dL}{d\\phi} = 0$$\n\nwhere $\\phi$ is the angular position of point $P$ on the spherical surface.\n\n::: {#cell-fig-fermat-spherical .cell execution_count=6}\n``` {.python .cell-code code-fold=\"true\"}\nimport numpy as np\nimport matplotlib.pyplot as plt\nfrom matplotlib.patches import Arc, Wedge\nimport matplotlib.patches as patches\n\n# Set up the figure\nfig, ax = plt.subplots(figsize=get_size(15, 10))\n\n# Parameters\nR = 3  # Radius of the spherical surface\nn1 = 1.0  # Refractive index of first medium\nn2 = 1.5  # Refractive index of second medium\narc_angle = 100  # Arc angle in degrees\ncenter_x = 3  # Center of arc is to the right of the boundary\n\n# Define the center of the sphere\ncenter = (center_x, 0)\n\n# Calculate arc angles in radians\nstart_angle = 180 - arc_angle/2\nend_angle = 180 + arc_angle/2\n\n# Draw the spherical surface as an arc\narc = Arc(center, 2*R, 2*R, theta1=start_angle, theta2=end_angle,\n          color='black', linewidth=1.5)\nax.add_patch(arc)\n\n# Calculate the x-coordinate of the leftmost point of the arc\nboundary_x = center_x - R * np.cos(np.radians(90 - arc_angle/2))\n\n# Draw the media boundary\nax.fill_between([-8, boundary_x], [-8, -8], [8, 8], color='lightblue', alpha=0.2)\nax.fill_between([boundary_x, 8], [-8, -8], [8, 8], color='lightgreen', alpha=0.2)\nax.axvline(x=boundary_x, color='black', linestyle='-', linewidth=1)\n\n# Add labels for the media\nax.text(boundary_x-2, 6, f\"n₁ = {n1}\", fontsize=12)\nax.text(boundary_x+2, 6, f\"n₂ = {n2}\", fontsize=12)\n\n# Mark object and image points\nobject_point = (boundary_x-3, 0)\nimage_point = (center_x+6, 0)\nax.plot(object_point[0], object_point[1], 'bo', markersize=8, label='Object (A)')\nax.plot(image_point[0], image_point[1], 'ro', markersize=8, label='Image (B)')\n\n# Calculate different potential paths along the arc\ntheta_rad = np.linspace(np.radians(start_angle), np.radians(end_angle), 15)\npaths = []\noptical_lengths = []\n\nfor theta in theta_rad:\n    # Position on the arc\n    x = center_x + R * np.cos(theta)\n    y = R * np.sin(theta)\n\n    # Calculate distances\n    d1 = np.sqrt((x - object_point[0])**2 + (y - object_point[1])**2)\n    d2 = np.sqrt((x - image_point[0])**2 + (y - image_point[1])**2)\n\n    # Calculate optical path length\n    optical_length = n1 * d1 + n2 * d2\n\n    paths.append((x, y))\n    optical_lengths.append(optical_length)\n\n# Find the minimum optical path\nmin_index = np.argmin(optical_lengths)\nmin_path = paths[min_index]\n\n# Plot all potential paths\nfor i, (x, y) in enumerate(paths):\n    if i == min_index:\n        continue\n    ax.plot([object_point[0], x, image_point[0]], [object_point[1], y, image_point[1]],\n             'gray', linestyle='--', alpha=0.5, linewidth=0.8)\n\n# Plot the path of minimum optical length (Fermat's principle)\nax.plot([object_point[0], min_path[0], image_point[0]], [object_point[1], min_path[1], image_point[1]],\n         'red', linewidth=2, label='Minimum optical path')\n\n\n# Set up the main plot\nax.set_xlim(-4, 12)\nax.set_ylim(-4, 4)\nax.set_xlabel('Position')\nax.set_ylabel('Height')\nax.grid(True, alpha=0.3)\nax.axhline(y=0, color='gray', linestyle='--', alpha=0.7)\nax.legend(loc='lower right')\n\nplt.tight_layout()\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Fermat's principle applied to a spherical refracting surface](01-lecture01_files/figure-html/fig-fermat-spherical-output-1.svg){#fig-fermat-spherical}\n:::\n:::\n\n\nUnder the paraxial approximation, we can express coordinates using small-angle approximations. If we place the origin at the center of the spherical surface, with objects at distance $a$ from the surface and images at distance $b$, the minimization condition leads to:\n\n$$n_1 \\sin \\theta_1 = n_2 \\sin \\theta_2$$\n\nWhere $\\theta_1$ and $\\theta_2$ are the angles with respect to the normal at point $P$.\n\nUsing the paraxial approximation $\\sin \\theta \\approx \\theta$ and geometric relations at the spherical surface, this simplifies to:\n\n$$\\frac{n_1}{a} + \\frac{n_2}{b} = \\frac{n_2-n_1}{R}$$\n\nThis is precisely the imaging equation for a spherical refracting surface that we derived earlier. The remarkable aspect is that Fermat's principle—the requirement that light follow the path of least time—naturally yields the same result as our geometric derivation.\n\n### Deriving the Thin Lens Equation from Fermat's Principle\n\nTo derive the thin lens equation, we apply Fermat's principle to the two spherical surfaces that make up a lens. Consider a lens with refractive index $n_2$ in a medium of index $n_1$, with surface radii $R_1$ and $R_2$.\n\nThe total optical path for a ray passing through the lens at height $y$ from the optical axis is:\n- Path from object to first surface: $n_1 s_1$\n- Path through the lens: $n_2 s_2$\n- Path from second surface to image: $n_1 s_3$\n\nFor a thin lens, the optical path length simplifies to:\n\n$$L(y) = n_1 \\sqrt{a^2 + y^2} + n_2 d(y) + n_1 \\sqrt{b^2 + y^2}$$\n\nWhere $d(y)$ is the thickness of the lens at height $y$, which can be approximated as:\n\n$$d(y) \\approx d_0 + \\frac{y^2}{2}\\left(\\frac{1}{R_1}-\\frac{1}{R_2}\\right)$$\n\nApplying Fermat's principle ($\\frac{dL}{dy} = 0$) and using the paraxial approximation:\n\n$$\\frac{n_1 y}{\\sqrt{a^2 + y^2}} + n_2 y \\left(\\frac{1}{R_1}-\\frac{1}{R_2}\\right) + \\frac{n_1 y}{\\sqrt{b^2 + y^2}} = 0$$\n\nIn the paraxial limit ($y \\ll a, y \\ll b$), this becomes:\n\n$$\\frac{n_1 y}{a} + n_2 y \\left(\\frac{1}{R_1}-\\frac{1}{R_2}\\right) + \\frac{n_1 y}{b} = 0$$\n\nDividing by $y$ and rearranging:\n\n$$\\frac{1}{a} + \\frac{1}{b} = \\frac{n_2-n_1}{n_1}\\left(\\frac{1}{R_1}-\\frac{1}{R_2}\\right) = \\frac{1}{f}$$\n\nThis is the thin lens equation with the focal length given by the lensmaker's equation:\n\n$$f = \\frac{n_1}{n_2-n_1}\\left(\\frac{R_1 R_2}{R_2-R_1}\\right)$$\n\nThus, both the imaging equation and the lensmaker equation emerge naturally from Fermat's principle applied to the geometry of a thin lens, showing that light follows paths of equal optical length from object to image when passing through any part of the lens.\n\nFrom a wave perspective, what makes a lens focus light to a point is that all paths from object to image through any part of the lens have equal optical path lengths (to first order in the paraxial approximation), ensuring constructive interference at the image point.\n\n",
    "supporting": [
      "01-lecture01_files"
    ],
    "filters": [],
    "includes": {}
  }
}