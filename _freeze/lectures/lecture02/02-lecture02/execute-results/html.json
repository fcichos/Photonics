{
  "hash": "b76d819edc79278a653906b20998cc46",
  "result": {
    "engine": "jupyter",
    "markdown": "---\njupyter: python3\nformat:\n  html:\n    toc: true\n    toc-location: right\n    fig-cap-location: bottom\ncrossref:\n  fig-title: Figure\n  tbl-title: Table\n  title-delim: —\n  fig-prefix: Figure\n  eq-prefix: Equation\n  chapters: true\n  fig-labels: arabic\ntitle: Theories for light\n---\n\n\n\n\n\n\n\n### Wave Optics\nWave optics extends our understanding beyond the limitations of geometric optics by treating light as a wave phenomenon. This approach explains effects that cannot be accounted for by ray tracing alone, such as:\n\n- Interference (the combination of waves)\n- Diffraction (the bending of waves around obstacles or through apertures)\n- Color (the wavelength-dependent nature of light)\n\nLight is part of the electromagnetic spectrum, which spans an enormous range of frequencies. The visible region, extending approximately from 400 nm (violet) to 700 nm (red), represents only a small fraction of this spectrum. This wave description is essential for understanding many optical phenomena that geometric optics cannot explain, particularly when dealing with structures comparable in size to the wavelength of light.\n\n::: {#fig-spectrum}\n![](img/spectrum.png){width=70%}\n\nElectromagnetic Spectrum with its different regions\n:::\n\nIn the following, we would like to introduce wave by discarding the fact, that light is related to electric and magnetic fields. This is useful as the vectorial nature of the electric and magnetic field further complicates the calculations, but we do not need those yet. Accordingly we also do not understand how light really interacts with matter and we therefore have to introduce some postulates as well.\n\n## Postulates of Wave Optics\n\n\n::: {.callout-note}\n## Wave\n\nA wave corresponds to a physical quantity which oscillates in space and time. Its energy current density is related to the square magnitude of the amplitude. A wave satisfies the wave equation.\n:::\n\n### Wave equation\n\n$$\n\\nabla^2 u - \\frac{1}{c^2}\\frac{\\partial^2 u}{\\partial t^2}=0\n$$\n\nwhere the Laplace operator $\\nabla^2$ is defined as:\n\n$$\n\\nabla^2 =\\frac{\\partial^2}{\\partial x^2}+\\frac{\\partial^2}{\\partial y^2}+\\frac{\\partial^2}{\\partial z^2}\n$$\n\nThe wave equation is a linear differential equation, which implies that the superposition principle holds. Specifically, if $u_1(\\mathbf{r},t)$ and $u_2(\\mathbf{r},t)$ are solutions of the wave equation, then any linear combination:\n\n$$\nu(\\mathbf{r},t)=a_1u_1(\\mathbf{r},t)+a_2u_2(\\mathbf{r},t)\n$$\n\nis also a solution, where $a_1$ and $a_2$ are arbitrary constants.\n\n### Monochromatic Wave\n\nA monochromatic wave consists of a single frequency $\\omega$. By definition, such a wave must be infinite in time and free from phase disturbances (such as sudden jumps). The mathematical expression for a monochromatic wave is:\n\n$$u(\\mathbf{r},t)=a(\\mathbf{r})\\cos(\\omega t + \\phi(\\mathbf{r}))$$\n\nwhere:\n\n- $a(\\mathbf{r})$ represents the amplitude\n- $\\phi(\\mathbf{r})$ represents the spatial phase\n- $\\omega$ represents the angular frequency\n\n::: {#fig-wave}\n![](img/wave.png){width=50%}\n\nRepresentation of a wavefunction over time (constant position) denoting the phase $\\phi$ and the period $T=1/\\nu$\n:::\n\n#### Complex Amplitude\n\nThe wave can be represented in complex form as:\n\n$$\nU(\\mathbf{r},t)=a(\\mathbf{r})e^{i\\phi(\\mathbf{r})}e^{i\\omega t}\n$$\n\nThis is known as the complex wavefunction.\n\n::: {#fig-complex-rep}\n![](img/complex_rep.png){width=70%}\n\nPhasor diagram of the complex amplitude $U(\\mathbf{r})$ (left) and $U(t)$ (right)\n:::\n\n\n::: {.callout-note}\nA phasor displays the complex amplitude with magnitude and phase as a vector in the complex plane.\n:::\n\nThe relationship between the complex and real wavefunctions is:\n\n$$\nu(\\mathbf{r},t)=\\text{Re}\\{U(\\mathbf{r},t)\\}=\\frac{1}{2}[U(\\mathbf{r},t)+U^*(\\mathbf{r},t)]\n$$\n\nThe complex wavefunction satisfies the same wave equation:\n\n$$\n\\nabla^2 U - \\frac{1}{c^2}\\frac{\\partial^2 U}{\\partial t^2}=0\n$$\n\nWe can separate the complex wavefunction into spatial and temporal components:\n\n$$\nU(\\mathbf{r},t)=U(\\mathbf{r})e^{i\\omega t}\n$$\n\nwhere\n\n$$\nU(\\mathbf{r})=a(\\mathbf{r})e^{i\\phi(\\mathbf{r})}\n$$\n\nHere, $\\phi$ represents the spatial phase of the wavefunction. Substituting this into the wave equation and noting that the time derivatives bring down factors of $i\\omega$:\n\n$$\\nabla^2 [U(\\mathbf{r})e^{i\\omega t}] - \\frac{1}{c^2}\\frac{\\partial^2}{\\partial t^2}[U(\\mathbf{r})e^{i\\omega t}] = 0$$\n$$\\nabla^2 U(\\mathbf{r})e^{i\\omega t} + \\frac{\\omega^2}{c^2}U(\\mathbf{r})e^{i\\omega t} = 0$$\n\nThe time dependence $e^{i\\omega t}$ factors out, leaving us with **the Helmholtz equation**:\n\n$$\\nabla^2 U(\\mathbf{r}) + k^2U(\\mathbf{r}) = 0$$\n\nwhere $k = \\omega/c$ is the wave number. This equation describes the spatial behavior of monochromatic waves.\n\n#### Intensity of Waves\n\nThe intensity of a wave at position $\\mathbf{r}$ and time $t$ is defined as:\n\n$$\nI(\\mathbf{r},t)=2\\langle u^2(\\mathbf{r},t)\\rangle\n$$\n\nwhere $I$ is measured in units of $\\left[\\frac{W}{m^2}\\right]$. The angle brackets $\\langle \\ldots \\rangle$ represent a time average over one oscillation cycle of $u$. For visible light, this averaging occurs over an extremely brief period - for example, light with a wavelength of 600 nm has a cycle duration of just 2 femtoseconds.\n\nThe optical power $P$ of a wave can be calculated by integrating the intensity over a surface area $A$:\n\n$$\nP=\\int_A I(\\mathbf{r},t) \\, dA\n$$\n\nInserting the seperation of the complex wavefunction into spatial and temporal components leads to the following expression for the intensity:\n\n$$\nI(\\mathbf{r})=|U(\\mathbf{r})|^2\n$$\n\nThus the physical quantity forming the spatial and temporal oscillation of the wavefunction is also providing the intensity of the wave when its magnitude is squared. This is a fundamental property of wavefunctions and for example not the case when temperature oscillates in space and time in a medium.\n\n#### Wavefronts\n\nWavefronts are surfaces in space where the phase is constant:\n\n$$\n\\phi(\\mathbf{r})=\\text{const}\n$$\n\nTypically, this constant is chosen to represent points of maximum spatial amplitude, such that:\n\n$$\n\\phi(\\mathbf{r})=2\\pi q\n$$\n\nwhere $q$ is an integer.\n\nThe direction normal to these wavefronts can be described by the gradient vector:\n\n$$\n\\mathbf{n}=\\nabla\\phi=\\left(\\frac{\\partial \\phi}{\\partial x},\\frac{\\partial \\phi}{\\partial y},\\frac{\\partial \\phi}{\\partial z}\\right)\n$$\n\nThis vector $\\mathbf{n}$ is always perpendicular to the wavefront surface and points in the direction of wave propagation. The evolution of these wavefronts in time provides important information about the wave's propagation characteristics.\n\n## Plane Waves\n\nA plane wave represents a fundamental solution of the homogeneous wave equation. In its complex form, it is expressed as:\n\n\\begin{equation}\nU(\\mathbf{r},t)=Ae^{-i\\mathbf{k}\\cdot \\mathbf{r}}e^{i\\omega t}\n\\end{equation}\n\nwhere:\n\n- The first exponential term contains the spatial phase\n- The second exponential term contains the temporal phase\n- $A$ is the (potentially complex) amplitude of the plane wave\n\nThe wavefront of a plane wave is defined by:\n\n$$\\mathbf{k}\\cdot \\mathbf{r}=2\\pi q + \\text{arg}(A)$$\n\nwhere $1$ is an integer. It just means that the projection of the position vector $\\mathbf{r}$ onto the wavevector $\\mathbf{k}$ is a multiple of $2\\pi$. This equation describes a plane perpendicular to the wavevector $\\mathbf{k}$. Adjacent wavefronts are separated by the wavelength $\\lambda=2\\pi/k$, where $k$ represents the spatial frequency of the wave oscillation.\n\nThe spatial component of the plane wave is given by:\n\n\\begin{equation}\nU(\\mathbf{r})=Ae^{-i\\mathbf{k}\\cdot \\mathbf{r}}\n\\end{equation}\n\nIn vacuum, the wavevector $\\mathbf{k}=\\mathbf{k}_0$ is real-valued and can be written as:\n\n\\begin{equation}\n\\mathbf{k}_0=\n\\begin{pmatrix}\nk_{0x} \\\\\nk_{0y}\\\\\nk_{0z}\\\\\n\\end{pmatrix}\n\\end{equation}\n\n\n::: {#cell-fig-plane .cell execution_count=2}\n``` {.python .cell-code code-fold=\"true\"}\ndef plane_wave(k,omega,r,t):\n    return(np.exp(1j*(np.dot(k,r)-omega*t)))\n\nwavelength=532e-9\nk0=2*np.pi/wavelength\nc=299792458\nomega0=k0*c\n\nvec=np.array([0.0,0.,1.])\nvec=vec/np.sqrt(np.dot(vec,vec))\n\nk=k0*vec\n\nx=np.linspace(-2.5e-6,2.5e-6,300)\nz=np.linspace(0,5e-6,300)\n\nX,Z=np.meshgrid(x,z)\nr=np.array([X,0,Z],dtype=object)\n\nplt.figure(figsize=get_size(6,6))\n\nfield=plane_wave(k,omega0,r,0)\n\nextent = np.min(z)*1e6, np.max(z)*1e6,np.min(x)*1e6, np.max(x)*1e6\nplt.imshow(np.real(field.transpose()),extent=extent,vmin=-1,vmax=1,cmap='seismic')\nplt.xlabel('z-position [µm]')\nplt.ylabel('x-position [µm]')\n\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Plane wave propagating along the z-direction](02-lecture02_files/figure-html/fig-plane-output-1.png){#fig-plane width=370 height=360}\n:::\n:::\n\n\n## Dispersion Relation\n\nUsing the plane wave solution\n\n\\begin{equation}\nU(\\mathbf{r},t)=Ae^{-i\\mathbf{k}\\cdot \\mathbf{r}}e^{i\\omega t}\n\\end{equation}\n\nwe can write down the sum of the spatial and temporal phase as\n\n$$\n\\phi(r,t)=\\omega t-\\mathbf{k}\\cdot \\mathbf{r}\n$$\n\nIf we select a point on the wavefront $\\mathbf{r}_{m}$, and follow that over time, the phase $\\phi(t)=\\text{const}$. Taking the time derivative results in\n\n$$\n\\mathbf{k}\\cdot \\frac{d\\mathbf{r}_{m}}{dt}=\\omega\n$$\n\nIf we choose the direction of the wavevector for measuring the propagation speed, i.e. $\\mathbf{r}_{m}=r_{m}\\mathbf{e}_k$ then we find for the propagation speed\n\n$$\n\\frac{dr_{m}}{dt}=\\frac{\\omega}{k}\n$$\n\nor in vacuum\n\n\\begin{equation}\nc_0=\\frac{\\omega}{k_0}\n\\end{equation}\n\nThis fundamental relationship connects:\n\n- The momentum ($k$),\n- The energy ($\\omega$)\n\nand is called a dispersion relation despite the fact, that we do not really understand why those quantities are related to energy and momentum.\n\n::: {.callout-note}\nLight in free space exhibits a linear dispersion relation, i.e. the frequency of light changes linearly with the wavevector magnitude.\n:::\n\nNote that if we choose a different propagation direction $\\mathbf{e}$ than the one along the wavevector $\\mathbf{e}_k$, we can write the phase velocity as\n\n$$\n\\mathbf{k}\\cdot\\mathbf{e} \\frac{dr}{dt}=k\\cos(\\measuredangle\\mathbf{k},\\mathbf{e}) \\frac{dr}{dt}=\\omega\n$$\n\nor\n\n$$\n\\frac{dr}{dt}=\\frac{\\omega}{k\\cos(\\measuredangle\\mathbf{k},\\mathbf{e})}\n$$\n\nwhich means that if you observe the wavepropagation not in the direction of the wavevector, the phase velocity is actually bigger than the speed of light and even tends to infinity if the angle between the wavevector and the observation direction tends to 90°.\n\n## Propagation in a Medium\n\nWhen a wave propagates through a medium:\n\n1. The frequency $\\omega$ remains constant (determined by the source)\n2. The wave speed changes according to:\n   $$\n   c=\\frac{c_0}{n}\n   $$\n   where $n$ is the refractive index of the medium\n\nThis leads to changes in:\n\n- the wavelength, which becomes shorter in the medium\n  $$\n  \\lambda=\\frac{\\lambda_0}{n}\n  $$\n\n- the length of the wavevector, which increases in the medium\n  $$\n  k=nk_0\n  $$\n\n\n\n## Snells Law\n\nThe change in the length of the wavevector has some simple consequence for Snells law. We can write Snells law as\n\n$$\nn_1k_0\\sin(\\theta_1)=n_2k_0\\sin(\\theta_2)\n$$\n\nwhere $k_0$ is the wavevector length in vacuum. As the $n_1k_0$ is the magnitude of the wavevector in medium 1, and $n_2k_0$ is the magnitude of the wavevector in medium 2, we can rewrite Snells law as\n\n$$\nk_1\\sin(\\theta_1)=k_2\\sin(\\theta_2)\n$$\n\nwhich means that the component of the wavevector parallel to the interface is conserved. If the wavevector has constant length then the wavevector incident at different angles is between a point on a circle and the origin in the diagram below. The circle corresponds to an isofrequency surface.\n\n::: {layout-ncol=3 column-width-left=\"40%\" column-width-middle=\"20%\" column-width-right=\"20%\"}\n\n::: {#5e2a6479 .cell execution_count=3}\n``` {.python .cell-code code-fold=\"true\"}\ntheta_upper = np.linspace(0, np.pi, 100)  # Upper half circle\ntheta_lower = np.linspace(np.pi, 2*np.pi, 100)  # Lower half circle\n\n# Radii for the circles\nr1 = 1.51  # Radius for upper half circle\nr2 = 1.01  # Radius for lower half circle\n\nx_upper = r1 * np.cos(theta_upper)\ny_upper = r1 * np.sin(theta_upper)\n\nx_lower = r2 * np.cos(theta_lower)\ny_lower = r2 * np.sin(theta_lower)\n\n# Create the plot\nplt.figure(figsize=get_size(4, 3),dpi=150)\nplt.plot(x_upper, y_upper, 'b-', label=f'Upper radius = {r1}')\nplt.plot(x_lower, y_lower, 'r-', label=f'Lower radius = {r2}')\n\n# Add arrow\n# Calculate arrow start point (on the upper circle at 135 degrees)\narrow_start_x = r1 * np.cos(3*np.pi/4.2)  # 135 degrees in radians\narrow_start_y = r1 * np.sin(3*np.pi/4.2)\n# Add arrow to origin (0,0)\nplt.arrow(arrow_start_x, arrow_start_y, -arrow_start_x, -arrow_start_y,\n          head_width=0.1, head_length=0.2, fc='b', ec='b',\n          length_includes_head=True, label='45° arrow')\n\ndy=np.sqrt(r2**2-arrow_start_x**2)\nplt.arrow(0, 0, -arrow_start_x, -dy,\n          head_width=0.1, head_length=0.2, fc='r', ec='r',\n          length_includes_head=True, label='45° arrow')\n\nplt.axhline(y=0, color='k', linestyle='-', alpha=0.3)\nplt.axvline(x=0, color='k', linestyle='-', alpha=0.3)\nplt.axvline(x=-arrow_start_x, color='k', linestyle='--',lw=0.5)\nplt.axvline(x=arrow_start_x, color='k', linestyle='--', lw=0.5)\n\nplt.axis('square')\n\nplt.grid(True, alpha=0.3)\nplt.xlabel(r'$k_x/k_0$')\nplt.ylabel(r'$k_y/k_0$')\nplt.xlim(-2,2 )\nplt.ylim(-2,2 )\n\n# Show the plot\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Snells law construction using the conservation of the wavevector component parallel to the interface. The vertical dashed lines indicate the parallal component of the wavevector in the two media.](02-lecture02_files/figure-html/cell-4-output-1.png){width=244 height=232}\n:::\n:::\n\n\n![Electron microscopy image of a 2D photonic crystal](img/pc_ex.png){width=90%}\n\n![Isofrequency surfaces of a photonic crystal](img/pc_iso.png){width=100%}\n:::\n\nIsofrequency surfaces can have non-spherical shape. In anisotropic media, they can be ellipsoids. In photonic crystals, i.e. crystals with a periodic structure on the scale of the wavelength, they can have a more complex shape.\n\n\n## Spherical Waves\n\nA spherical wave, like a plane wave, consists of spatial and temporal components, but with wavefronts forming spherical surfaces. For spherical waves, $|\\mathbf{k}||\\mathbf{r}|=kr=\\text{const}$. Given a source at position $\\mathbf{r}_0$, the spherical wave can be expressed as:\n\n\\begin{equation}\nU=\\frac{A}{|\\mathbf{r}-\\mathbf{r}_0|}e^{-ik|\\mathbf{r}-\\mathbf{r}_0|} e^{i\\omega t}\n\\end{equation}\n\n::: {.callout-important}\nThe $1/|\\mathbf{r}-\\mathbf{r}_0|$ factor in the amplitude is necessary for energy conservation - ensuring that the total energy flux through any spherical surface centered on the source remains constant.\n:::\n\n::: {#cell-fig-sphere .cell execution_count=4}\n``` {.python .cell-code code-fold=\"true\"}\ndef spherical_wave(k,omega,r,r0,t):\n    k=np.linalg.norm(k)\n    d=np.linalg.norm(r-r0)\n    return( np.exp(1j*(k*d-omega*t))/d)\n\nplt.figure(figsize=get_size(5,5),dpi=150)\n\nx=np.linspace(-5e-6,5e-6,300)\nz=np.linspace(-5e-6,5e-6,300)\n\nX,Z=np.meshgrid(x,z)\nr=np.array([X,0,Z],dtype=object)\n\nwavelength=532e-9\nk0=2*np.pi/wavelength\nc=299792458\nomega0=k0*c\n\nk=k0*np.array([0,0,1.])\nr0=np.array([0,0,0])\n\nfield=spherical_wave(k,omega0,r,r0,0)\n\nextent = np.min(z)*1e6, np.max(z)*1e6,np.min(x)*1e6, np.max(x)*1e6\nplt.imshow(np.real(field.transpose()),extent=extent,vmin=-5e6,vmax=5e6,cmap='seismic')\n\nplt.xlabel('z [µm]')\nplt.ylabel('x [µm]')\nplt.show()\n```\n\n::: {.cell-output .cell-output-display}\n![Spherical wave propagation. The wave is emitted from the origin and propagates in the positive z-direction. The wavefronts are spherical surfaces. The wave is visualized in the xz-plane.](02-lecture02_files/figure-html/fig-sphere-output-1.png){#fig-sphere width=331 height=314 fig-align='center'}\n:::\n:::\n\n\nNote: The direction of wave propagation can be reversed by changing the sign of the wavenumber $k$.\n\n",
    "supporting": [
      "02-lecture02_files"
    ],
    "filters": [],
    "includes": {}
  }
}