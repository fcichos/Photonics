{
  "hash": "2c666c05e18cf631ae17a4476292825d",
  "result": {
    "engine": "jupyter",
    "markdown": "---\njupyter: python3\nformat:\n  html:\n    toc: true\n    toc-location: right\n    fig-cap-location: bottom\ncrossref:\n  fig-title: Figure\n  tbl-title: Table\n  title-delim: —\n  fig-prefix: Figure\n  eq-prefix: Equation\n  chapters: true\n  fig-labels: arabic\ntitle: Theories for light\n---\n\n\n\n\n\n\n\n### Refraction at Spherical Surfaces\n\nWhen light encounters a spherical boundary between two media, we can analyze its path using Snell's law and geometric considerations as shown below:\n\n::: {#fig-curved-surface fig-align=\"center\"}\n![](img/curved_surface.png){width=80%}\n\nRefraction at a curved surface.\n:::\n\nTo determine how an image forms, we need to find where rays originating from a point at distance $a$ from the surface will converge after refraction. Using Snell's law for a ray hitting the surface at angle $\\alpha+\\theta_1$:\n\n$$n_{1}\\sin(\\alpha+\\theta_1)=n_{2}\\sin(\\alpha-\\theta_2)$$\n\nWhere:\n$$\\sin(\\alpha)=\\frac{y}{R}, \\quad \\tan(\\theta_1)=\\frac{y}{a}, \\quad \\tan(\\theta_2)=\\frac{y}{b}$$\n\nFor practical optical systems, we employ the **paraxial approximation**, where all angles are assumed small enough that:\n\n$$\\sin(\\theta) \\approx \\theta+ O(\\theta^{3}), \\quad \\tan(\\theta) \\approx \\theta + O(\\theta^{3}),\\quad \\cos(\\theta)\\approx 1 + O(\\theta^{2})$$\n\nThis simplifies Snell's law to:\n\n$$n_1(\\alpha+\\theta_1)=n_2(\\alpha-\\theta_2)$$\n\nAfter appropriate transformations (detailed in the online lecture), we obtain:\n\n$$\\theta_2=\\frac{n_2-n_1}{n_2 R}y -\\frac{n_1}{n_2}\\theta_1$$\n\nand\n\n$$y=y_1=y_2$$\n\n\nThis linear relationship between input ($y$, $\\theta_1$) and output ($y$,$\\theta_2$) parameters is a hallmark of paraxial optics and a result of the linearization of Snells law.\n\n### Matrix Optics\n\nThe linear relation between input and output parameters allows us to express optical elements as linear transformations (matrices). This approach forms the foundation of **matrix optics**. For a lens, the matrix representation is:\n\n$$\\begin{pmatrix} y_2 \\\\ \\theta_2 \\end{pmatrix} = \\begin{pmatrix} 1 & 0 \\\\ -\\frac{1}{f} & 1 \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ \\theta_1 \\end{pmatrix}$$\n\nThis 2×2 matrix is called the **ABCD matrix** of the lens. Thanks to the linearization of Snell's law, we can generalize this to any optical element:\n\n$$\\begin{pmatrix} y_2 \\\\\n\\theta_2 \\end{pmatrix} = \\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix} \\begin{pmatrix} y_1 \\\\ \\theta_1 \\end{pmatrix}$$\n\nEach element in the ABCD matrix has a specific physical meaning:\n\n| Matrix Element | Physical Meaning |\n|----------------|------------------|\n| A | Magnification - relates output position to input position |\n| B | Position-to-angle conversion - relates output position to input angle |\n| C | Focusing power - relates output angle to input position |\n| D | Angular magnification - relates output angle to input angle |\n\nEvery optical element can be characterized by these parameters. For example, a lens has C = -1/f (focusing power), while free space has B = d (position-dependent angle change). An important property is that the determinant of the matrix equals the ratio of refractive indices: det(M) = n₁/n₂, which equals 1 in a single medium.\n\nHere are the ABCD matrices for common optical elements:\n\n$$\n\\mathbf{M}=\\begin{bmatrix}\nA & B\\\\\nC & D\n\\end{bmatrix} =\\left[\\begin{array}{ll}\n1 & d \\\\\n0 & 1\n\\end{array}\\right] \\tag{Free space}\n$$\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{cc}\n1 & 0 \\\\\n0 & \\frac{n_1}{n_2}\n\\end{array}\\right] \\tag{Planar interface}\n$$\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{\\left(n_2-n_1\\right)}{n_2 R} & \\frac{n_1}{n_2}\n\\end{array}\\right] \\tag{Spherical Boundary}\n$$\n\n$$\n\\mathbf{M}=\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f} & 1\n\\end{array}\\right] \\tag{Thin Lens}\n$$\n\nFor a system containing multiple optical elements, we simply multiply their matrices in the order that light passes through them:\n\n$$\n\\mathrm{M}=\\mathbf{M}_N \\cdots \\mathbf{M}_2 \\mathbf{M}_1\n$$\n\nA ray entering the first optical element at a height $y_1$ at an angle $\\theta_1$ is transformed according to the matrix $\\mathbf{M}$ by the whole system. This elegant approach provides a powerful tool for analyzing complex optical systems efficiently.\n\n\n::: {.callout-note collapse=true}\n### Example: Optical Cloaking with Lens Systems\n\nOptical cloaking refers to making objects \"invisible\" by guiding light rays around them such that to an observer, it appears as if the rays traveled through free space without encountering any object. Using matrix optics, we can design such a system.\n\n::: {#fig-cloaking fig-align=\"center\"}\n![](img/cloacking.png){width=80%}\n\nExample of a practical paraxial cloak. (a)–(c) A hand is cloaked for varying directions, while the background image is transmitted properly.(d) On-axis view of the ray optics cloaking device. (e) Setup using practical, easy to obtain optics, for demonstrating paraxial cloaking principles. (Photos by J. Adam Fenster, videos by Matthew Mann / University of Rochester) [Source](https://opg.optica.org/oe/fulltext.cfm?uri=oe-22-24-29465&id=304785)\n:::\n\n\nFor perfect optical cloaking, the ABCD matrix of our system must be equivalent to that of free space:\n\n$$\n\\mathbf{M}_{cloaking} = \\left[\\begin{array}{cc}\n1 & d \\\\\n0 & 1\n\\end{array}\\right]\n$$\n\nWhere $d$ is the total effective optical path length. Let's explore why we need exactly 4 lenses to achieve this.\n\n#### Analysis of Different Lens Configurations\n\n**1. Single Lens Configuration**\n\nFor a single lens with focal length $f$, the ABCD matrix is:\n\n$$\n\\mathbf{M}_{single} = \\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f} & 1\n\\end{array}\\right]\n$$\n\nThis clearly cannot match the free space matrix due to the non-zero $C$ element.\n\n**2. Two-Lens Configuration**\n\nFor two lenses with focal lengths $f_1$ and $f_2$ separated by distance $d_{12}$:\n\n$$\n\\mathbf{M}_{two} = \\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f_2} & 1\n\\end{array}\\right]\n\\left[\\begin{array}{cc}\n1 & d_{12} \\\\\n0 & 1\n\\end{array}\\right]\n\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f_1} & 1\n\\end{array}\\right]\n$$\n\nWhen $d_{12} = f_1 + f_2$ (telescopic arrangement), this simplifies to:\n\n$$\n\\mathbf{M}_{two} = \\left[\\begin{array}{cc}\n-\\frac{f_1}{f_2} & 0 \\\\\n0 & -\\frac{f_2}{f_1}\n\\end{array}\\right]\n$$\n\nSince both magnification ($A$) and angular magnification ($D$) cannot simultaneously equal 1 while maintaining $\\det(\\mathbf{M}) = 1$, two lenses are insufficient.\n\n**3. Three-Lens Configuration**\n\nWith three lenses, we have more parameters but still need to determine if we can satisfy all constraints simultaneously. For a three-lens system with focal lengths $f_1$, $f_2$, and $f_3$, separated by distances $d_{12}$ and $d_{23}$, the system matrix would be:\n\n$$\n\\mathbf{M}_{three} =\n\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f_3} & 1\n\\end{array}\\right]\n\\left[\\begin{array}{cc}\n1 & d_{23} \\\\\n0 & 1\n\\end{array}\\right]\n\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f_2} & 1\n\\end{array}\\right]\n\\left[\\begin{array}{cc}\n1 & d_{12} \\\\\n0 & 1\n\\end{array}\\right]\n\\left[\\begin{array}{cc}\n1 & 0 \\\\\n-\\frac{1}{f_1} & 1\n\\end{array}\\right]\n$$\n\nWhen multiplied out, the focusing power (C element) of the system is:\n\n$$C = -\\frac{1}{f_3} - \\frac{1}{f_2} - \\frac{1}{f_1} + \\frac{d_{12}}{f_1f_2} + \\frac{d_{23}}{f_2f_3} + \\frac{d_{12}d_{23}}{f_1f_2f_3}$$\n\nThe magnification (A element) of the system is:\n\n$$A = 1 - \\frac{d_{12}}{f_1} - \\frac{d_{23}}{f_2} + \\frac{d_{12}d_{23}}{f_1f_2}$$\n\nFor perfect cloaking, we need both C = 0 and A = 1. From A = 1, we can derive:\n\n$$\\frac{d_{12}}{f_1} + \\frac{d_{23}}{f_2} - \\frac{d_{12}d_{23}}{f_1f_2} = 0$$\n\nSolving for $d_{23}$, we get:\n\n$$d_{23} = \\frac{d_{12}/f_1}{1/f_2 - d_{12}/(f_1f_2)}$$\n\nSubstituting this into the condition for C = 0, we obtain a complex expression that places constraints on the possible values of $f_1$, $f_2$, and $f_3$. For typical lens configurations, this results in values that are difficult to realize physically, as it often requires either negative separations or negative focal lengths.\n\nWhile the three-lens system provides more parameters to work with than the two-lens system, the mathematical constraints of simultaneously achieving zero focusing power (C = 0) and unit magnification (A = 1) still make perfect cloaking challenging with conventional optical elements.\n\n\n**4. Four-Lens Configuration: The Solution**\n\nWe can arrange four lenses in two pairs:\n\n- First pair (lenses 1 and 2): A beam compressor\n- Second pair (lenses 3 and 4): A beam expander\n\nFor the beam compressor, with lenses at their combined focal length apart:\n\n$$\n\\mathbf{M}_{comp} = \\left[\\begin{array}{cc}\n-\\frac{f_1}{f_2} & 0 \\\\\n0 & -\\frac{f_2}{f_1}\n\\end{array}\\right]\n$$\n\nSimilarly, for the beam expander:\n\n$$\n\\mathbf{M}_{exp} = \\left[\\begin{array}{cc}\n-\\frac{f_3}{f_4} & 0 \\\\\n0 & -\\frac{f_4}{f_3}\n\\end{array}\\right]\n$$\n\nThe combined system matrix is:\n\n$$\n\\mathbf{M}_{total} = \\mathbf{M}_{exp} \\times \\mathbf{M}_{comp} = \\left[\\begin{array}{cc}\n\\frac{f_1}{f_2} \\times \\frac{f_3}{f_4} & 0 \\\\\n0 & \\frac{f_2}{f_1} \\times \\frac{f_4}{f_3}\n\\end{array}\\right]\n$$\n\nFor perfect cloaking, we need:\n- $\\frac{f_1}{f_2} \\times \\frac{f_3}{f_4} = 1$\n- $\\frac{f_2}{f_1} \\times \\frac{f_4}{f_3} = 1$\n\nThis is satisfied when $f_1 = f_4$ and $f_2 = f_3$.\n\nWith the lenses properly spaced and an additional free space distance $d_0$ between the two pairs, the complete system matrix becomes:\n\n$$\n\\mathbf{M}_{cloaking} = \\left[\\begin{array}{cc}\n1 & d_0 \\\\\n0 & 1\n\\end{array}\\right]\n$$\n\nWhich perfectly mimics free space propagation, creating the optical cloaking effect.\n\n\n::: {#63c39fd2 .cell execution_count=2}\n``` {.python .cell-code}\n# Example of optical cloaking with four lenses using raytracing\nfrom raytracing import *\n\n# Define focal lengths (in mm)\nf1 = 200\nf2 = 75\nf3 = f2  # f3 = f2 = 75\nf4 = f1  # f4 = f1 = 200\n\n# Create an optical path\npath = ImagingPath()\n\n# Add the four lenses with proper spacing\npath.append(Space(d=100))  # Initial space before first lens\npath.append(Lens(f=f1, label=f\"f₁={f1}mm\"))\npath.append(Space(d=f1+f2))  # Distance between lens 1 and 2\npath.append(Lens(f=f2, label=f\"f₂={f2}mm\"))\npath.append(Space(d=100))  # Distance between lens pairs (d₀)\npath.append(Lens(f=f3, label=f\"f₃={f3}mm\"))\npath.append(Space(d=f3+f4))  # Distance between lens 3 and 4\npath.append(Lens(f=f4, label=f\"f₄={f4}mm\"))\npath.append(Space(d=100))  # Final space after last lens\n\n# Display the ray path with custom figure size\n\npath.display(raysList=[\n    [Ray(y=5, theta=0)],\n    [Ray(y=-5, theta=0)]\n], interactive=False)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nBeginnerHint [in figure.py]: Infinite field of view: cannot use limitObjectToFieldOfView=True. The object height is instead set to the default value of 10.0.\nBeginnerHint [in imagingpath.py]: Field of view is infinite. You can pass useObject=True to use the finite objectHeight.\nBeginnerHint [in figure.py]: No aperture stop in the system: cannot use onlyPrincipalAndAxialRays=True since they are not defined. Showing the default ObjectRays instead. \n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](01-lecture02_files/figure-html/cell-3-output-2.png){width=850 height=589}\n:::\n:::\n\n\n:::\n\n\n### Multifocal Imaging\n\nWe would like to explore the concept of multifocal imaging to obtain 3D resolution from a single image.\nIn a microscope, an objective lens together with a tube lens is used to focus light from a sample onto a detector. Either the tube lens is no modified to shift the focal plane of the objective lens or one uses multiple tube lenses with different focal lengths with a single objective lens.\n\n\n::: {#fig-multifocal-adapter fig-align=\"center\"}\n![](img/multifocal_imaging.png){width=80%}\n\nThe multifocal adapter. (a) Composition of the multifocal imaging setup. The multifocal adapter (MFA) is inserted into the light path between a standard dark-field microscope and a camera. (b) Composition of the multifocal adapter. Incoming light from the microscope is infinity projected by the lens f1 and split by three consecutive beam-splitters (b1 = 25/75; b2 = 33/67; b3 = 50/50). Five mirrors (m) guide the light into four separate optical paths. The lens f5 projects the four images onto the camera chip. The inter-plane distance is set by lenses of different focal length (f1 - f4). (c, d) Experimentally acquired (c) and simulated (d) (see Methods) multifocal dark-field images (planes 1 - 4, 20x objective) of a calibration grid at the four focal positions (indicated on the left side), where one of the four focal planes maps the grid sharply. Scale bar represents 20 µm. Experiment was performed six times with similar results. [Source](https://www.nature.com/articles/s41467-021-24768-4)\n:::\n\n\n\nIn the simplest configuration of an objective lens and a tube lens, the light first travels from the object to the objective lens in free space for a distance $s$, which is represented by\n\n::: {#70b40882 .cell execution_count=4}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=4}\n$$\nM_1=\\left[\\begin{matrix}1 & s\\\\0 & 1\\end{matrix}\\right]\n$$\n:::\n:::\n\n\nThen it is passing the objective lens with\n\n::: {#e50fd32e .cell execution_count=5}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=5}\n$$\nM_2=\\left[\\begin{matrix}1 & 0\\\\- \\frac{1}{f_{1}} & 1\\end{matrix}\\right]\n$$\n:::\n:::\n\n\ntraveling further through free space with distance $d$\n\n::: {#bc09e663 .cell execution_count=6}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=6}\n$$\nM_3=\\left[\\begin{matrix}1 & d\\\\0 & 1\\end{matrix}\\right]\n$$\n:::\n:::\n\n\nand then hitting the tube lens with\n\n::: {#5c35512b .cell execution_count=7}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=7}\n$$\nM_4=\\left[\\begin{matrix}1 & 0\\\\- \\frac{1}{\\Delta_{ft} + f_{t}} & 1\\end{matrix}\\right]\n$$\n:::\n:::\n\n\nwhere $\\Delta_ft$ is a parameter modifying the original tube lens focal distance $f_t$.\nFinally, the light will propagate to the detector at distance $f_t$ from the tube lens\n\n::: {#5d76de39 .cell execution_count=8}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=8}\n$$\nM_s=\\left[\\begin{matrix}1 & f_{t}\\\\0 & 1\\end{matrix}\\right]\n$$\n:::\n:::\n\n\ngicing for the whole system:\n\n\n$$\nM_t=M_4 M_3 M_2 M_1\n$$\n\nThe final matrix has again 4 parameters $A,B,C$ and $D$. For sharp imaging the parameter $B$ of the system must be equal to zero, as the outgoing light should be independent of the incoming angle. This is achieved\n\n::: {#8b475739 .cell execution_count=9}\n\n::: {.cell-output .cell-output-display .cell-output-markdown execution_count=9}\n$$\\delta s=\\frac{f_{1} \\left(\\Delta_{ft} d + \\Delta_{ft} f_{t} + f_{t}^{2}\\right)}{\\Delta_{ft} d - \\Delta_{ft} f_{1} + \\Delta_{ft} f_{t} + f_{t}^{2}}-s_0\n$$\n:::\n:::\n\n\n::: {#cell-fig-shift .cell execution_count=10}\n\n::: {.cell-output .cell-output-display}\n![Plot of the solution with specific parameter values](01-lecture02_files/figure-html/fig-shift-output-1.png){#fig-shift width=565 height=447}\n:::\n:::\n\n\n::: {.callout-note collapse=true}\n## The B Parameter\n\nThe **B parameter** is the most direct indicator of a sharp image in matrix optics.\nFor an optical system with ABCD matrix:\n$$\n\\begin{pmatrix} y_2 \\\\ \\theta_2 \\end{pmatrix} =\n\\begin{pmatrix} A & B \\\\ C & D \\end{pmatrix}\n\\begin{pmatrix} y_1 \\\\ \\theta_1 \\end{pmatrix}\n$$\n\nThe output position is given by:\n$$y_2 = Ay_1 + B\\theta_1$$\n\nFor an image to be sharp, all rays originating from the same object point must converge to a single image point, regardless of their initial angles. This means that for a given $y_1$ (object position), the final position $y_2$ must be independent of the initial angle $\\theta_1$.\n\nThis condition is satisfied when **B = 0**.\n\nWhen B = 0:\n- The final position depends only on the initial position ($y_2 = Ay_1$)\n- All rays from a point source converge to a single point in the image plane\n- The imaging is \"stigmatic\" (point-to-point mapping)\n\nIn our lens example, the system matrix was:\n$$\n\\mathbf{M}_{system} =\n\\left[\\begin{array}{cc}\n1-\\frac{d}{f} & d \\\\\n-\\frac{1}{f} & 1\n\\end{array}\\right]\n$$\n\nFor parallel input rays (different $y_1$ but all $\\theta_1 = 0$), we needed A = 0 to make them all converge to a single point, which happened when d = f.\n\nBut for general imaging of points (not just parallel rays), the B = 0 condition is what determines whether the image is sharp. This is why, in optical design, finding conjugate planes (where B = 0) is essential for sharp imaging.\n:::\n\n",
    "supporting": [
      "01-lecture02_files"
    ],
    "filters": [],
    "includes": {}
  }
}